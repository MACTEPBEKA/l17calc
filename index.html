<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<title>Калькулятор урона</title>
</head>
<body>

<style>
	.Row {
		display: table;
		width: 90%; /*Optional*/
		table-layout: fixed; /*Optional*/
	}
	.Column {
		display: table-cell;
		width: 100%;
	}
	.div-border {
		border: 4px solid black;
		padding: 8px; 
	}
	input::-webkit-inner-spin-button {
		-webkit-appearance: none;
		margin: 0;
	}
</style>
<script>
	function get_dmg() {
		if (stab.checked){
			stab_coef = 1.5;
		} else {
			stab_coef = 1;
		}
		
		
		switch (type.value) {
			case "x025":
				type_coef = 0.25;
				break;
			case "x05":
				type_coef = 0.5;
				break;
			case "x1":
				type_coef = 1;
				break;
			case "x2":
				type_coef = 2;
				break;
			case "x4":
				type_coef = 4;
				break;
			default:
				alert("Error!");
				break;
		}
		
		switch (mod_att.value) {
			case "-6":
				att_stat = att.value*2/(2+6);
				break;
			case "-5":
				att_stat = att.value*2/(2+5);
				break;
			case "-4":
				att_stat = att.value*2/(2+4);
				break;
			case "-3":
				att_stat = att.value*2/(2+3);
				break;
			case "-2":
				att_stat = att.value*2/(2+2);
				break;
			case "-1":
				att_stat = att.value*2/(2+1);
				break;
			case "0":
				att_stat = att.value;
				break;
			case "+1":
				att_stat = att.value*(2+1)/2;
				break;
			case "+2":
				att_stat = att.value*(2+2)/2;
				break;
			case "+3":
				att_stat = att.value*(2+3)/2;
				break;
			case "+4":
				att_stat = att.value*(2+4)/2;
				break;
			case "+5":
				att_stat = att.value*(2+5)/2;
				break;
			case "+6":
				att_stat = att.value*(2+6)/2;
				break;
			default:
				alert("Ошибка при вычислении модификацированного стата атаки");
				break;
		}
		
		switch (mod_def.value) {
			case "-6":
				def_stat = def.value*2/(2+6);
				break;
			case "-5":
				def_stat = def.value*2/(2+5);
				break;
			case "-4":
				def_stat = def.value*2/(2+4);
				break;
			case "-3":
				def_stat = def.value*2/(2+3);
				break;
			case "-2":
				def_stat = def.value*2/(2+2);
				break;
			case "-1":
				def_stat = def.value*2/(2+1);
				break;
			case "0":
				def_stat = def.value;
				break;
			case "+1":
				def_stat = def.value*(2+1)/2;
				break;
			case "+2":
				def_stat = def.value*(2+2)/2;
				break;
			case "+3":
				def_stat = def.value*(2+3)/2;
				break;
			case "+4":
				def_stat = def.value*(2+4)/2;
				break;
			case "+5":
				def_stat = def.value*(2+5)/2;
				break;
			case "+6":
				def_stat = def.value*(2+6)/2;
				break;
			default:
				alert("Ошибка при вычислении модификацированного стата защиты");
				break;
		}
		
		if (in_fire.checked){
			in_fire_coef = 0.5;
		} else {
			in_fire_coef = 1;
		}
				
		if (screen.checked){
			screen_coef = 0.5;
		} else {
			screen_coef = 1;
		}
		
		if (absorb.checked){
			absorb_coef = 0.9;
		} else {
			absorb_coef = 1;
		}
		
		switch (item.value) {
			case "Отсутствует":
				item_coef = 1;
				break;
			case "Стабовый":
				item_coef = 1.1;
				break;
			case "Сфера ярости":
				item_coef = 1.25;
				break;
			default:
				alert("Ошибка при вычислении усиления предметом");
				break;
		}
		
		oth = 1 * absorb_coef * screen_coef * in_fire_coef * item_coef;
		
		dmg = ((2*lvl.value + 10)/250*att_stat/def_stat*base.value + 2)*stab_coef*type_coef*oth
		
		min_dmg.textContent = Math.floor(dmg * 0.85);
		max_dmg.textContent = Math.floor(dmg);
		maxcrit_dmg.textContent = Math.floor(dmg * 1.5);
		
	}
	function test() {
		lvl.value = 78;
		att.value = 245;
		def.value = 261;
		base.value = 40;
		stab.checked = true;
	}
	function clear_calc() {
		lvl.value = null;
		att.value = null;
		def.value = null;
		base.value = null;
		stab.checked = false;
		item.value = "Отсутствует";
		in_fire.checked = false;
		screen.checked = false;
		mod_att.value = "0";
		mod_def.value = "0";
		absorb.checked = false;
	}
</script>	
	
	<div name="dmg_calc" class="div-border">
		<div class="Row">
			<div class="Column">
				Уровень
			</div>
			<div class="Column">
				Мощность
			</div>
			<div class="Column">
				Стат атаки
			</div>
			<div class="Column">
				Стат защиты
			</div>
			<div class="Column">
				Эфф. типа
			</div>
			<div class="Column">
				Стабовая
			</div>
			<div class="Column">
				Предмет
			</div>
		</div>
		<div class="Row">
			<div class="Column">
				<input id="lvl" type="number" style="width: 70%">
			</div>
			<div class="Column">
				<input id="base" type="number" style="width: 70%">
			</div>
			<div class="Column">
				<input id="att" type="number" style="width: 70%">
			</div>
			<div class="Column">
				<input id="def" type="number" style="width: 70%">
			</div>
			<div class="Column">
				<select id="type">
					<option value="x025">x0.25</option>
					<option value="x05">x0.5</option>
					<option value="x1" selected="selected">x1</option>
					<option value="x2">x2</option>
					<option value="x4">x4</option>
				</select>
			</div>
			<div class="Column">
				<input id="stab" type="checkbox" >
			</div>
			<div class="Column">
				<select id="item">
					<option value="Отсутствует" selected="selected">Отсутствует</option>
					<option value="Стабовый">Стабовый</option>
					<option value="Сфера ярости">Сфера ярости</option>
				</select>
			</div>
		</div>
		<div class="Row" style="margin-top: 20px">
			<div class="Column">
				В огне
			</div>
			<div class="Column">
				Экран
			</div>
			<div class="Column">
				Модификация атаки
			</div>
			<div class="Column">
				Модификация защиты
			</div>
			<div class="Column">
			</div>
			<div class="Column">
			</div>
			<div class="Column">
				Асборбер
			</div>			
		</div>
		<div class="Row">
			<div class="Column">
				<input id="in_fire" type="checkbox" >
			</div>
			<div class="Column">
				<input id="screen" type="checkbox" >
			</div>
			<div class="Column">
				<select id="mod_att">
					<option value="-6">-6</option>
					<option value="-5">-5</option>
					<option value="-4">-4</option>
					<option value="-3">-3</option>
					<option value="-2">-2</option>
					<option value="-1">-1</option>
					<option value="0" selected="selected">0</option>
					<option value="+1">+1</option>
					<option value="+2">+2</option>
					<option value="+3">+3</option>
					<option value="+4">+4</option>
					<option value="+5">+5</option>
					<option value="+6">+6</option>
				</select>
			</div>
			<div class="Column">
				<select id="mod_def">
					<option value="-6">-6</option>
					<option value="-5">-5</option>
					<option value="-4">-4</option>
					<option value="-3">-3</option>
					<option value="-2">-2</option>
					<option value="-1">-1</option>
					<option value="0" selected="selected">0</option>
					<option value="+1">+1</option>
					<option value="+2">+2</option>
					<option value="+3">+3</option>
					<option value="+4">+4</option>
					<option value="+5">+5</option>
					<option value="+6">+6</option>
				</select>
			</div>
			<div class="Column">
			
			</div>
			<div class="Column">
			</div>
			<div class="Column">
				<input id="absorb" type="checkbox" >
			</div>
		</div>
		
		<div class="Row" style="margin-top: 20px">
			<div class="Column">
			</div>
			<div class="Column">
			</div>
			<div class="Column">
			</div>
			<div class="Column">
			</div>
			<div class="Column">
				Минимальный урон
			</div>
			<div class="Column">
				Максимальный урон
			</div>
			<div class="Column">
				Максимальный урон c крита
			</div>
		</div>
		<div class="Row">
			<div class="Column">
				<button id="calc_dmg" onclick="get_dmg()" style="width: 70%">Вычислить урон</button>
			</div>
			<div class="Column">
				<button id="clear_btn" onclick="clear_calc()" style="width: 70%">Очистить</button>
			</div>
			<div class="Column">
				<button id="test_calc" onclick="test()" style="width: 70%">Тест</button>
			</div>
			<div class="Column">
			</div>
			<div class="Column" id="min_dmg">
			</div>
			<div class="Column" id="max_dmg">
			</div>
			<div class="Column" id="maxcrit_dmg">
			</div>
		</div>
	</div>
	
	
</body>
</html>